# 课程接口使用说明（创建与更新）

本文档说明课程创建与更新接口的最新入参规范（已移除课程层 coachFee 字段），并给出单/多教师的请求示例。

## 总览
- 基础路径：`/api/courses`
- 认证：需要携带 `Authorization: Bearer <token>`

## 一、创建课程
- 方法：`POST /api/courses/create`
- 入参：`CourseCreateRequest`

字段说明：
- `name` (string) 课程名称，必填
- `typeId` (long) 课程类型ID（系统常量ID），必填
- `status` (enum) 课程状态：`PUBLISHED`、`DRAFT`、`DISABLED` 等，必填
- `unitHours` (decimal) 单次课时，必填，大于0
- `price` (decimal) 课程单价，必填，大于0
- `isMultiTeacher` (boolean) 是否多教师，默认 false
- `coachFees` (array) 教练课时费列表：单/多教师均使用此列表
  - `coachId` (long) 教练ID，必填
  - `coachFee` (decimal) 该教练课时费，必填，>=0
- `campusId` (long) 校区ID，必填
- `description` (string) 课程描述，可选

说明：
- 已移除顶层 `coachFee` 入参，不再需要传。课程表中的 `coach_fee` 为冗余字段：
  - 多教师：自动保存为 `0.00`
  - 单教师：自动取 `coachFees[0].coachFee`

示例（单教师）：
```json
{
  "name": "少儿舞蹈-单教师",
  "typeId": 1,
  "status": "PUBLISHED",
  "unitHours": 1.0,
  "price": 199.00,
  "isMultiTeacher": false,
  "coachFees": [
    { "coachId": 1, "coachFee": 80.00 }
  ],
  "campusId": 1,
  "description": "单教师课程"
}
```

示例（多教师）：
```json
{
  "name": "少儿舞蹈-多教师",
  "typeId": 1,
  "status": "PUBLISHED",
  "unitHours": 1.5,
  "price": 299.00,
  "isMultiTeacher": true,
  "coachFees": [
    { "coachId": 1, "coachFee": 90.00 },
    { "coachId": 2, "coachFee": 100.00 }
  ],
  "campusId": 1,
  "description": "多教师课程"
}
```

返回：
- 成功：`{ "code": 200, "data": <courseId> }`

## 二、更新课程
- 方法：`POST /api/courses/update`
- 入参：`CourseUpdateRequest`

字段说明：
- `id` (long) 课程ID，必填
- 其他字段与创建一致：名称、类型、状态、单次课时、单价、是否多教师、coachFees、校区ID、描述

说明：
- 多教师：只根据 `coachFees` 更新课程-教练关联，课程表冗余 `coach_fee` 写 `0.00`
- 单教师：根据 `coachFees[0].coachFee` 同步写入课程表冗余 `coach_fee`

示例（单教师更新）：
```json
{
  "id": 1001,
  "name": "少儿舞蹈-单教师-更新",
  "typeId": 1,
  "status": "PUBLISHED",
  "unitHours": 1.0,
  "price": 209.00,
  "isMultiTeacher": false,
  "coachFees": [ { "coachId": 1, "coachFee": 88.00 } ],
  "campusId": 1,
  "description": "单教师课程更新"
}
```

示例（多教师更新）：
```json
{
  "id": 1002,
  "name": "少儿舞蹈-多教师-更新",
  "typeId": 1,
  "status": "PUBLISHED",
  "unitHours": 1.5,
  "price": 319.00,
  "isMultiTeacher": true,
  "coachFees": [ { "coachId": 2, "coachFee": 110.00 } ],
  "campusId": 1,
  "description": "多教师课程更新"
}
```

返回：
- 成功：`{ "code": 200, "message": "success" }`
- 失败：`{ "code": 500, "message": "错误信息" }`

## 三、注意事项
- 单教师模式必须确保 `coachFees` 仅有一条；多教师模式至少一条
- `coachId` 必须存在且属于该机构与校区，否则会被拒绝
- 若更新导致校区变更，系统会自动更新校区统计的课程数量（Redis）

## 四、测试
- 已提供测试脚本：`test_course_api.sh`
  - 请先替换 `TOKEN` 与示例ID
  - 运行：`chmod +x test_course_api.sh && ./test_course_api.sh`
  - 脚本会依次测试：单教师创建、多教师创建、详情查询、单教师更新、多教师更新、分页列表