# 课程排序功能增强报告

## 功能概述
为课程管理添加更多排序字段支持，包括ID、课程单价、总课时、已销课时等字段的排序功能。

## 新增排序字段

### 1. 基础字段排序
- **id**: 按课程ID排序
- **name**: 按课程名称排序
- **status**: 按课程状态排序
- **type/typeId**: 按课程类型排序

### 2. 价格相关字段排序
- **price**: 按课程单价排序
- **coachFee/coach_fee**: 按教练费用排序

### 3. 课时相关字段排序
- **totalHours/total_hours**: 按总课时排序
- **consumedHours/consumed_hours**: 按已销课时排序
- **unitHours/unit_hours**: 按单次课时排序

### 4. 时间相关字段排序
- **createdTime/createdtime/created_time**: 按创建时间排序
- **updatedTime/updatedtime/updated_time**: 按更新时间排序

## 代码实现

### 1. 更新排序字段处理逻辑
**文件**: `src/main/java/com/lesson/model/EduCourseModel.java`

```java
private SortField<?> getSortField(String field, String order) {
  Field<?> sortField;
  switch (field.toLowerCase()) {
    case "id":
      sortField = EDU_COURSE.ID;
      break;
    case "name":
      sortField = EDU_COURSE.NAME;
      break;
    case "type":
    case "typeid":
      sortField = EDU_COURSE.TYPE_ID;
      break;
    case "status":
      sortField = EDU_COURSE.STATUS;
      break;
    case "price":
      sortField = EDU_COURSE.PRICE;
      break;
    case "totalhours":
    case "total_hours":
      sortField = EDU_COURSE.TOTAL_HOURS;
      break;
    case "consumedhours":
    case "consumed_hours":
      sortField = EDU_COURSE.CONSUMED_HOURS;
      break;
    case "unithours":
    case "unit_hours":
      sortField = EDU_COURSE.UNIT_HOURS;
      break;
    case "coachfee":
    case "coach_fee":
      sortField = EDU_COURSE.COACH_FEE;
      break;
    case "createtime":
    case "createdtime":
    case "created_time":
      sortField = EDU_COURSE.CREATED_TIME;
      break;
    case "updatetime":
    case "updatedtime":
    case "updated_time":
      sortField = EDU_COURSE.UPDATE_TIME;
      break;
    default:
      sortField = EDU_COURSE.ID;
      break;
  }

  return "desc".equalsIgnoreCase(order) ? sortField.desc() : sortField.asc();
}
```

### 2. 更新API文档
**文件**: `src/main/java/com/lesson/vo/request/CourseQueryRequest.java`

```java
@Schema(description = "排序字段：id-按ID排序，name-按课程名称排序，price-按课程单价排序，totalHours-按总课时排序，consumedHours-按已销课时排序，unitHours-按单次课时排序，coachFee-按教练费用排序，createdTime-按创建时间排序，updatedTime-按更新时间排序", example = "createdTime")
private String sortField;
```

## 功能特性

### 1. 大小写不敏感
- 排序字段名称支持大小写不敏感匹配
- 例如：`price`、`Price`、`PRICE` 都可以

### 2. 多种命名格式支持
- 支持驼峰命名：`totalHours`、`consumedHours`
- 支持下划线命名：`total_hours`、`consumed_hours`
- 支持无分隔符命名：`createdtime`、`updatedtime`

### 3. 排序方向
- **asc**: 升序排列
- **desc**: 降序排列

### 4. 默认排序
- 当排序字段不存在或无效时，默认按ID排序

## 测试用例

### 1. 按ID排序（升序）
```
GET /api/courses/list?sortField=id&sortOrder=asc
```

### 2. 按课程单价排序（降序）
```
GET /api/courses/list?sortField=price&sortOrder=desc
```

### 3. 按总课时排序（升序）
```
GET /api/courses/list?sortField=totalHours&sortOrder=asc
```

### 4. 按已销课时排序（降序）
```
GET /api/courses/list?sortField=consumedHours&sortOrder=desc
```

### 5. 按单次课时排序（升序）
```
GET /api/courses/list?sortField=unitHours&sortOrder=asc
```

### 6. 按教练费用排序（降序）
```
GET /api/courses/list?sortField=coachFee&sortOrder=desc
```

### 7. 按课程名称排序（升序）
```
GET /api/courses/list?sortField=name&sortOrder=asc
```

### 8. 按更新时间排序（降序）
```
GET /api/courses/list?sortField=updatedTime&sortOrder=desc
```

### 9. 组合筛选和排序
```
GET /api/courses/list?typeIds=11&typeIds=12&sortField=price&sortOrder=desc&campusId=1
```

## 支持的排序字段列表

| 字段名 | 支持格式 | 描述 |
|--------|----------|------|
| id | id | 课程ID |
| name | name | 课程名称 |
| type | type, typeid | 课程类型 |
| status | status | 课程状态 |
| price | price | 课程单价 |
| totalHours | totalHours, total_hours | 总课时 |
| consumedHours | consumedHours, consumed_hours | 已销课时 |
| unitHours | unitHours, unit_hours | 单次课时 |
| coachFee | coachFee, coach_fee | 教练费用 |
| createdTime | createdTime, createdtime, created_time | 创建时间 |
| updatedTime | updatedTime, updatedtime, updated_time | 更新时间 |

## 编译验证
- ✅ 项目编译成功
- ✅ 无语法错误
- ✅ 无类型错误

## 总结

成功为课程管理添加了完整的排序功能支持：

1. **新增9个排序字段**: ID、课程单价、总课时、已销课时、单次课时、教练费用、课程名称、创建时间、更新时间
2. **多种命名格式**: 支持驼峰、下划线、无分隔符等多种命名格式
3. **大小写不敏感**: 排序字段名称支持大小写不敏感匹配
4. **向后兼容**: 保持原有排序功能不变
5. **API文档完善**: 更新了排序字段的详细说明

现在课程列表支持丰富的排序功能，可以满足各种业务场景的需求。 